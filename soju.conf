# Soju IRC Bouncer Configuration
# Based on o3-irc-howto.md specifications

# Server identification
hostname irc.curia.network
title "CommonGround IRC Bouncer"

# Listeners
# TLS IRC for clients
listen ircs://0.0.0.0:6697
# WebSocket for web clients
listen wss://0.0.0.0:443

# TLS configuration
tls /etc/soju/certs/fullchain.pem /etc/soju/certs/privkey.pem

# Database configuration (PostgreSQL)
db postgres "${DATABASE_URL}"

# Message storage
message-store db

# WebSocket/HTTP configuration
http-origin https://embed.curia.network https://curia.network
http-ingress https://irc.curia.network

# Authentication (placeholder for development - will use HTTP auth in production)
# For development, comment out the auth line and use internal auth
# auth http ${SOJU_AUTH_URL}

# User management
enable-user-on-auth true
max-user-networks 1

# Logging
log fs /var/lib/soju/logs

# Admin configuration (configured via sojuctl after startup)

# File upload (optional)
# upstream-user-ip ${SOJU_UPSTREAM_USER_IP}

# Rate limiting (using supported directives)
# Note: timeout directives vary by Soju version

# Connection settings (multi-upstream-mode removed - unsupported)